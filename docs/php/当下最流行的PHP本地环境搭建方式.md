# 当下最流行的PHP本地环境搭建方式

> 本文主要是互联网从业者视角，介绍一种PHP本地开发环境搭建的最佳实践方法。全文共计1630字，作者：凌枫。如果文章对你有帮助，请关注和转发，谢谢！

## 一、传统环境搭建方式已过时

### 1、曾经用过的本地环境搭建方式

初学者福音，一键安装包。刚入行的时候，也曾经使用过PHPStudy、XAMP、MAMP。这是最简单、最快速的搭建方式，特别适合刚入行的初级开发者。假如没有这种便捷工具，估计自己也要被本地开发环境搭建给劝退。

极致酷炫版，基于虚拟机的方式。在进阶到高级开发者后，要经常爬上服务器，于是迷上了CentOS。非常享受手撸本地开发环境的感觉，输入一行yum命令，终端就开始滚动起来，非常酷炫。可以非常轻松的安装Nginx、PHP、Redis、MySQL等等，而且可以手动修改各类配置。

### 2、本地开发环境的核心痛点

本地开发环境搭建究竟是容易还是难。在漫长的工作历程中，曾经遇到很多人搞不定本地开发环境，不管是刚入行的新人，还是有经验的从业者，都曾遇到过。对于大多数人来说，搭建本地开发环境，大概有这两种方式。方式一：现场Google搜索，现场安装；方式二：打开工具箱记事本，喝着咖啡安装。多问一句，公司用了什么奇怪奇奇的扩展版本，看着错误日志，你能搞定吗？

开箱即用的本地开发环境，可定制、可分享、版本随切。你是否遇到以下问题？有多台电脑，需要配置多遍，还没法保持统一环境；每次换工作都要花1-2天时间跑项目；新员工入职，搞不定开发环境，有人用Mac有人用Windows；公司项目跑在7.x版本的PHP，想体验一下8.x版本的PHP。

团队：需要一个定制的开箱即用本地开发环境，下次有人问起，直接甩过去。个人：一个属于自己的本地开发环境。

### 3、让本地开发环境变得时髦些

本地开发环境也要追求时髦，也可以内嵌到Docker里面。开箱即用 = docker-compose up。耳边天天都在响起起拥抱云原生，似乎跟普通开发不搭边。而当你把本地开发环境内嵌到Docker里面之后，脑海中的这种想法就彻底消失了，你发现在本地可以把4核CPU分配1核给Docker，换而言之，对公司容器化可以提高机器资源的利用率。

公司测试和生产环境都在用容器，而通过本地环境Docker化，你将拥有一个本地实践的机会。在捣腾了很多年，贴合现在工作和个人诉求，终于找到一款好东西：DNMP — 当下最流行的PHP本地环境搭建方式。

## 二、DNMP简单介绍

### 1、DNMP简介

什么是DNMP呢？DNMP = Docker + Nginx + MySQL + PHP + Redis + ElasticSearch + MongoDB + RabbitMQ，是一款全功能的LNMP一键安装程序，也支持Arm CPU。

我心目中的DNMP是什么？基于当下流行的Docker方式，囊括PHP开发的所有运行依赖，只要稍加裁剪即可以完成定制。

### 2、包含功能

文件配置等于运行环境。之前不管是一键安装包，还是虚拟机方式，多少有点让人摸不着头脑的感觉。在你拥有了DNMP之后，瞬间让你感觉深入了源码的感觉。通过配置docker-compose.yml文件，可以定制所需要的services，比如nginx是一个service，php74也是一个service；每个运行的service的环境变量全部在env文件。

### 3、内置丰富的PHP扩展

内置多达152种常见和不常见的PHP扩展。被本地开发环境折磨的一个点，肯定少不了PHP扩展，不管你的编译安装还是源安装的方式，过程肯定非常痛苦。而DNMP内置了几乎所有的PHP扩展，数量多达152种，你需要做的就是设置为启用即可。

## 三、从零开始搭建DNMP开发环境

### 1、三步轻松完成初始化

第一步：克隆项目，git clone https://github.com/zeszao/dnmp.git

第二步：拷贝并命名配置文件，env.sample、docker-compose.sample.yml

第三步：浏览器访问 https://localhost 即可看到效果

### 2、如何在项目中使用

第一步：将你的应用放进项目目录。将工作中需要用到的应用，都放进本地电脑的~/Workshop路径下。

```text
～/Workshop $ tree ~/Workshop -L 1
/Users/colin/Workshop
├── api-a
├── api-b
├── api-c
└── api-d
```

第二步：将项目根目录挂载进容器。修改docker-compose.yml文件配置。

```yaml
version: "3"
services:
  php82:
    volumes:
      - ~/Workshop:/home/www 
```

第三步：逐个配置nginx的root路径。文件路径为services/nginx/conf.d/api-x.conf

```text
server {
    server_name api-x.com;
    listen 80:
    
    root /home/www/api-x/public;
    index index.php index.html index.htm;
}
```

嗯，在项目中使用，就是这么简单方便。

综上所述：DNMP是一种当下最佳的PHP本地搭建方式，不管你是刚入行还是经验丰富开发者。

如果文章对你有帮助，请关注和转发，谢谢！
![qr](../assets/qr.png)
